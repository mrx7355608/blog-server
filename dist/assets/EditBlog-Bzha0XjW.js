import{j as t,b as v,r as c,c as w,M as N}from"./index-CLWBLKRV.js";import{u as E,S as _}from"./useAuthFetch-CPLIqvMY.js";import{E as k}from"./Editor-XgKjM1iS.js";import{e as S}from"./blog.services-B9F6rO5L.js";function C({error:u}){return t.jsxs("div",{className:"pt-12 w-full h-full flex items-center justify-start flex-col",children:[t.jsx("h1",{className:"text-4xl text-gray-100 font-black",children:"Oops! An Error Occurred"}),t.jsx("p",{className:"text-gray-500 mt-4 font-regular text-xl",children:u})]})}function U(){const{showSuccessToast:u,showErrorToast:d}=v(),[x,f]=c.useState(!1),[e,m]=c.useState({title:"",content:"",summary:"",tags:[],_id:"",slug:"",published_on:"",is_published:!0}),h=c.useRef(null),{id:b}=w(),g=`http://localhost:8000/api/blogs/id/${b}`,{loading:j,error:r,response:l}=E(g);if(c.useEffect(()=>{l&&m(l.data)},[l]),j)return t.jsx(N,{});if(r)return t.jsx(C,{error:r});return t.jsxs("div",{className:"py-8",children:[t.jsx("h1",{className:"font-bold text-4xl mb-5",children:"Edit Blog"}),t.jsx("input",{onChange:i,className:"input input-bordered input-lg mb-3 w-full",name:"title",type:"text",placeholder:"Title",value:e.title}),t.jsx(k,{ref:h,apiKey:"w8qyt0vomahy4wblhojsfalcs66u28mso8tatcda4itxkrev",init:{plugins:"anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount",toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table | align lineheight | numlist bullist indent outdent | emoticons charmap | removeformat",content_css:"/tinymce_darktheme.css"},initialValue:e.content}),t.jsx("p",{className:"mt-8 mb-2 text-lg mt-8",children:"Tags"}),t.jsx("input",{className:"input input-bordered w-full",name:"tags",onChange:i,placeholder:"Add tags (separated by comma)",value:e.tags.join(",")}),t.jsx("p",{className:"mt-8 mb-2 text-lg mt-8",children:"Summary"}),t.jsx("textarea",{className:"input input-bordered w-full",name:"summary",onChange:i,placeholder:"Write brief and concise blog summary",value:e.summary}),t.jsx("p",{className:"mt-8 mb-2 text-lg",children:"Select publishing status"}),t.jsxs("select",{className:"select select-bordered w-full max-w-xs",name:"is_published",onChange:i,children:[t.jsx("option",{value:"published",selected:!0,children:"Published"}),t.jsx("option",{value:"draft",children:"Draft"})]}),r?t.jsx("p",{className:"bg-red-200 text-red-700 text-lg font-medium p-3 w-full mt-3 rounded-md",children:r}):null,t.jsx("button",{onClick:y,className:"mt-8 btn btn-info w-full",children:x?t.jsx(_,{}):"Update"})]});function i(a){const{name:s,value:n}=a.target;if(s==="tags")return m({...e,tags:n.split(","),_id:e._id});m({...e,[s]:n,_id:e._id})}async function y(){var n,p;let a={};const s=l==null?void 0:l.data;(s==null?void 0:s.title)!==e.title&&(a.title=e.title),(s==null?void 0:s.content)!==((p=(n=h.current)==null?void 0:n.editor)==null?void 0:p.getContent())&&(a.content=e.content),(s==null?void 0:s.tags.join(","))!==e.tags.join(",")&&(a.tags=e.tags),(s==null?void 0:s.summary)!==e.summary&&(a.summary=e.summary),f(!0);try{const o=await S(e._id,a);if(o)return d(o);u("Edited successfully")}catch(o){d(o.message)}finally{f(!1)}}}export{U as default};
